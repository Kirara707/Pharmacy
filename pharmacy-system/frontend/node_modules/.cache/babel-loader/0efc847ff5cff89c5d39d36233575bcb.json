{"remainingRequest":"C:\\Users\\lizhe\\Desktop\\database\\pharmacy-system\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\lizhe\\Desktop\\database\\pharmacy-system\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\lizhe\\Desktop\\database\\pharmacy-system\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\lizhe\\Desktop\\database\\pharmacy-system\\frontend\\src\\views\\Users.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\lizhe\\Desktop\\database\\pharmacy-system\\frontend\\src\\views\\Users.vue","mtime":1750158434869},{"path":"C:\\Users\\lizhe\\Desktop\\database\\pharmacy-system\\frontend\\babel.config.js","mtime":1750140439609},{"path":"C:\\Users\\lizhe\\Desktop\\database\\pharmacy-system\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1750139103810},{"path":"C:\\Users\\lizhe\\Desktop\\database\\pharmacy-system\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1750139103814},{"path":"C:\\Users\\lizhe\\Desktop\\database\\pharmacy-system\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1750139103810},{"path":"C:\\Users\\lizhe\\Desktop\\database\\pharmacy-system\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1750139102365}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgcmVmLCByZWFjdGl2ZSwgY29tcHV0ZWQsIG9uTW91bnRlZCB9IGZyb20gJ3Z1ZSc7CmltcG9ydCB7IHVzZVN0b3JlIH0gZnJvbSAndnVleCc7CmltcG9ydCB7IEVsTWVzc2FnZSwgRWxNZXNzYWdlQm94IH0gZnJvbSAnZWxlbWVudC1wbHVzJzsKaW1wb3J0IHsgVXNlciwgTG9jayB9IGZyb20gJ0BlbGVtZW50LXBsdXMvaWNvbnMtdnVlJzsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdVc2VycycsCiAgc2V0dXAoKSB7CiAgICBjb25zdCBzdG9yZSA9IHVzZVN0b3JlKCk7CiAgICBjb25zdCBsb2FkaW5nID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IGRpYWxvZ1Zpc2libGUgPSByZWYoZmFsc2UpOwogICAgY29uc3Qgc3VibWl0TG9hZGluZyA9IHJlZihmYWxzZSk7CiAgICBjb25zdCB1c2VyRm9ybVJlZiA9IHJlZihudWxsKTsKICAgIGNvbnN0IHVzZXJGb3JtID0gcmVhY3RpdmUoewogICAgICB1c2VybmFtZTogJycsCiAgICAgIHBhc3N3b3JkOiAnJywKICAgICAgcm9sZTogJycKICAgIH0pOwogICAgY29uc3QgcnVsZXMgPSB7CiAgICAgIHVzZXJuYW1lOiBbewogICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXnlKjmiLflkI0nLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9LCB7CiAgICAgICAgbWluOiAzLAogICAgICAgIG1heDogMjAsCiAgICAgICAgbWVzc2FnZTogJ+eUqOaIt+WQjemVv+W6puW6lOWcqDMtMjDkuKrlrZfnrKbkuYvpl7QnLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9XSwKICAgICAgcGFzc3dvcmQ6IFt7CiAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeWvhueggScsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH0sIHsKICAgICAgICBtaW46IDYsCiAgICAgICAgbWF4OiAyMCwKICAgICAgICBtZXNzYWdlOiAn5a+G56CB6ZW/5bqm5bqU5ZyoNi0yMOS4quWtl+espuS5i+mXtCcsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH1dLAogICAgICByb2xlOiBbewogICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgIG1lc3NhZ2U6ICfor7fpgInmi6nop5LoibInLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH1dCiAgICB9OwogICAgY29uc3QgdXNlcnMgPSBjb21wdXRlZCgoKSA9PiBzdG9yZS5zdGF0ZS51c2Vycy5saXN0KTsKICAgIGNvbnN0IHVzZXJSb2xlID0gY29tcHV0ZWQoKCkgPT4gewogICAgICB2YXIgX3N0b3JlJHN0YXRlJGF1dGgkdXNlOwogICAgICByZXR1cm4gKF9zdG9yZSRzdGF0ZSRhdXRoJHVzZSA9IHN0b3JlLnN0YXRlLmF1dGgudXNlcikgPT09IG51bGwgfHwgX3N0b3JlJHN0YXRlJGF1dGgkdXNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfc3RvcmUkc3RhdGUkYXV0aCR1c2Uucm9sZTsKICAgIH0pOwogICAgY29uc3QgY2FuQWRkVXNlciA9IGNvbXB1dGVkKCgpID0+IHsKICAgICAgcmV0dXJuIFsnYWRtaW4nLCAncGhhcm1hY3lfYWRtaW4nXS5pbmNsdWRlcyh1c2VyUm9sZS52YWx1ZSk7CiAgICB9KTsKICAgIGNvbnN0IGNhbkVkaXRVc2VyID0gY29tcHV0ZWQoKCkgPT4gewogICAgICByZXR1cm4gWydhZG1pbicsICdwaGFybWFjeV9hZG1pbiddLmluY2x1ZGVzKHVzZXJSb2xlLnZhbHVlKTsKICAgIH0pOwogICAgY29uc3QgYXZhaWxhYmxlUm9sZXMgPSBjb21wdXRlZCgoKSA9PiB7CiAgICAgIGlmICh1c2VyUm9sZS52YWx1ZSA9PT0gJ2FkbWluJykgewogICAgICAgIHJldHVybiBbewogICAgICAgICAgdmFsdWU6ICdhZG1pbicsCiAgICAgICAgICBsYWJlbDogJ+ezu+e7n+euoeeQhuWRmCcKICAgICAgICB9LCB7CiAgICAgICAgICB2YWx1ZTogJ3BoYXJtYWN5X2FkbWluJywKICAgICAgICAgIGxhYmVsOiAn6I2v5bqX566h55CG5ZGYJwogICAgICAgIH0sIHsKICAgICAgICAgIHZhbHVlOiAnc2FsZXNwZXJzb24nLAogICAgICAgICAgbGFiZWw6ICfplIDllK7kurrlkZgnCiAgICAgICAgfV07CiAgICAgIH0gZWxzZSBpZiAodXNlclJvbGUudmFsdWUgPT09ICdwaGFybWFjeV9hZG1pbicpIHsKICAgICAgICByZXR1cm4gW3sKICAgICAgICAgIHZhbHVlOiAnc2FsZXNwZXJzb24nLAogICAgICAgICAgbGFiZWw6ICfplIDllK7kurrlkZgnCiAgICAgICAgfV07CiAgICAgIH0KICAgICAgcmV0dXJuIFtdOwogICAgfSk7CiAgICBjb25zdCBnZXRSb2xlVHlwZSA9IHJvbGUgPT4gewogICAgICBjb25zdCB0eXBlcyA9IHsKICAgICAgICBhZG1pbjogJ2RhbmdlcicsCiAgICAgICAgcGhhcm1hY3lfYWRtaW46ICd3YXJuaW5nJywKICAgICAgICBzYWxlc3BlcnNvbjogJ3N1Y2Nlc3MnCiAgICAgIH07CiAgICAgIHJldHVybiB0eXBlc1tyb2xlXSB8fCAnaW5mbyc7CiAgICB9OwogICAgY29uc3QgZ2V0Um9sZU5hbWUgPSByb2xlID0+IHsKICAgICAgY29uc3QgbmFtZXMgPSB7CiAgICAgICAgYWRtaW46ICfns7vnu5/nrqHnkIblkZgnLAogICAgICAgIHBoYXJtYWN5X2FkbWluOiAn6I2v5bqX566h55CG5ZGYJywKICAgICAgICBzYWxlc3BlcnNvbjogJ+mUgOWUruS6uuWRmCcKICAgICAgfTsKICAgICAgcmV0dXJuIG5hbWVzW3JvbGVdIHx8IHJvbGU7CiAgICB9OwogICAgY29uc3QgY2FuRGVsZXRlVXNlciA9IHVzZXIgPT4gewogICAgICBpZiAodXNlclJvbGUudmFsdWUgPT09ICdhZG1pbicpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgICBpZiAodXNlclJvbGUudmFsdWUgPT09ICdwaGFybWFjeV9hZG1pbicpIHsKICAgICAgICByZXR1cm4gdXNlci5yb2xlID09PSAnc2FsZXNwZXJzb24nOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH07CiAgICBjb25zdCBmZXRjaFVzZXJzID0gYXN5bmMgKCkgPT4gewogICAgICB0cnkgewogICAgICAgIGxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICAgIGF3YWl0IHN0b3JlLmRpc3BhdGNoKCd1c2Vycy9mZXRjaFVzZXJzJyk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKGVycm9yLm1lc3NhZ2UpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIGxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IHNob3dBZGREaWFsb2cgPSAoKSA9PiB7CiAgICAgIC8vIOmHjee9ruihqOWNleaVsOaNrgogICAgICBPYmplY3QuYXNzaWduKHVzZXJGb3JtLCB7CiAgICAgICAgdXNlcm5hbWU6ICcnLAogICAgICAgIHBhc3N3b3JkOiAnJywKICAgICAgICByb2xlOiAnJwogICAgICB9KTsKICAgICAgZGlhbG9nVmlzaWJsZS52YWx1ZSA9IHRydWU7CiAgICAgIC8vIOa4hemZpOihqOWNlemqjOivgQogICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICBpZiAodXNlckZvcm1SZWYudmFsdWUpIHsKICAgICAgICAgIHVzZXJGb3JtUmVmLnZhbHVlLmNsZWFyVmFsaWRhdGUoKTsKICAgICAgICB9CiAgICAgIH0sIDEwMCk7CiAgICB9OwogICAgY29uc3QgaGFuZGxlRGVsZXRlID0gYXN5bmMgcm93ID0+IHsKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCBFbE1lc3NhZ2VCb3guY29uZmlybSgn56Gu5a6a6KaB5Yig6Zmk6L+Z5Liq55So5oi35ZCX77yfJywgJ+itpuWRiicsIHsKICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICAgIH0pOwogICAgICAgIGNvbnN0IHRva2VuID0gc3RvcmUuc3RhdGUuYXV0aC50b2tlbjsKICAgICAgICBjb25zdCBjb25maWcgPSB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3Rva2VufWAKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGF3YWl0IGF4aW9zLmRlbGV0ZShgaHR0cDovL2xvY2FsaG9zdDo1MDAwL2FwaS91c2Vycy8ke3Jvdy5pZH1gLCBjb25maWcpOwogICAgICAgIEVsTWVzc2FnZS5zdWNjZXNzKCfliKDpmaTmiJDlip8nKTsKICAgICAgICBmZXRjaFVzZXJzKCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgaWYgKGVycm9yICE9PSAnY2FuY2VsJykgewogICAgICAgICAgdmFyIF9lcnJvciRyZXNwb25zZSwgX2Vycm9yJHJlc3BvbnNlJGRhdGE7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoKChfZXJyb3IkcmVzcG9uc2UgPSBlcnJvci5yZXNwb25zZSkgPT09IG51bGwgfHwgX2Vycm9yJHJlc3BvbnNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2Vycm9yJHJlc3BvbnNlJGRhdGEgPSBfZXJyb3IkcmVzcG9uc2UuZGF0YSkgPT09IG51bGwgfHwgX2Vycm9yJHJlc3BvbnNlJGRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lcnJvciRyZXNwb25zZSRkYXRhLm1lc3NhZ2UpIHx8ICfliKDpmaTlpLHotKUnKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBjb25zdCBoYW5kbGVTdWJtaXQgPSBhc3luYyAoKSA9PiB7CiAgICAgIGlmICghdXNlckZvcm1SZWYudmFsdWUpIHJldHVybjsKICAgICAgdHJ5IHsKICAgICAgICAvLyDpqozor4HooajljZUKICAgICAgICBhd2FpdCB1c2VyRm9ybVJlZi52YWx1ZS52YWxpZGF0ZSgpOwogICAgICAgIHN1Ym1pdExvYWRpbmcudmFsdWUgPSB0cnVlOwoKICAgICAgICAvLyDorr7nva7or7fmsYLlpLQKICAgICAgICBjb25zdCB0b2tlbiA9IHN0b3JlLnN0YXRlLmF1dGgudG9rZW47CiAgICAgICAgY29uc3QgY29uZmlnID0gewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0b2tlbn1gLAogICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBhd2FpdCBheGlvcy5wb3N0KCdodHRwOi8vbG9jYWxob3N0OjUwMDAvYXBpL3VzZXJzJywgdXNlckZvcm0sIGNvbmZpZyk7CiAgICAgICAgRWxNZXNzYWdlLnN1Y2Nlc3MoJ+eUqOaIt+a3u+WKoOaIkOWKnycpOwogICAgICAgIGRpYWxvZ1Zpc2libGUudmFsdWUgPSBmYWxzZTsKICAgICAgICBmZXRjaFVzZXJzKCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign5o+Q5Lqk6ZSZ6K+vOicsIGVycm9yKTsKICAgICAgICBpZiAoZXJyb3IucmVzcG9uc2UpIHsKICAgICAgICAgIHZhciBfZXJyb3IkcmVzcG9uc2UkZGF0YTI7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoKChfZXJyb3IkcmVzcG9uc2UkZGF0YTIgPSBlcnJvci5yZXNwb25zZS5kYXRhKSA9PT0gbnVsbCB8fCBfZXJyb3IkcmVzcG9uc2UkZGF0YTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lcnJvciRyZXNwb25zZSRkYXRhMi5tZXNzYWdlKSB8fCAn5pON5L2c5aSx6LSlJyk7CiAgICAgICAgfSBlbHNlIGlmIChlcnJvci5tZXNzYWdlKSB7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoZXJyb3IubWVzc2FnZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcign6K+35qOA5p+l6L6T5YWl5piv5ZCm5q2j56GuJyk7CiAgICAgICAgfQogICAgICB9IGZpbmFsbHkgewogICAgICAgIHN1Ym1pdExvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKICAgIG9uTW91bnRlZCgoKSA9PiB7CiAgICAgIGZldGNoVXNlcnMoKTsKICAgIH0pOwogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZywKICAgICAgdXNlcnMsCiAgICAgIGRpYWxvZ1Zpc2libGUsCiAgICAgIHVzZXJGb3JtLAogICAgICB1c2VyRm9ybVJlZiwKICAgICAgcnVsZXMsCiAgICAgIGNhbkFkZFVzZXIsCiAgICAgIGNhbkVkaXRVc2VyLAogICAgICBhdmFpbGFibGVSb2xlcywKICAgICAgZ2V0Um9sZVR5cGUsCiAgICAgIGdldFJvbGVOYW1lLAogICAgICBjYW5EZWxldGVVc2VyLAogICAgICBzaG93QWRkRGlhbG9nLAogICAgICBoYW5kbGVEZWxldGUsCiAgICAgIGhhbmRsZVN1Ym1pdCwKICAgICAgc3VibWl0TG9hZGluZywKICAgICAgVXNlciwKICAgICAgTG9jawogICAgfTsKICB9Cn07"},{"version":3,"names":["ref","reactive","computed","onMounted","useStore","ElMessage","ElMessageBox","User","Lock","axios","name","setup","store","loading","dialogVisible","submitLoading","userFormRef","userForm","username","password","role","rules","required","message","trigger","min","max","users","state","list","userRole","_store$state$auth$use","auth","user","canAddUser","includes","value","canEditUser","availableRoles","label","getRoleType","types","admin","pharmacy_admin","salesperson","getRoleName","names","canDeleteUser","fetchUsers","dispatch","error","showAddDialog","Object","assign","setTimeout","clearValidate","handleDelete","row","confirm","type","token","config","headers","delete","id","success","_error$response","_error$response$data","response","data","handleSubmit","validate","post","console","_error$response$data2"],"sources":["C:\\Users\\lizhe\\Desktop\\database\\pharmacy-system\\frontend\\src\\views\\Users.vue"],"sourcesContent":["<template>\r\n  <div class=\"users-container\">\r\n    <div class=\"header\">\r\n      <h2>用户管理</h2>\r\n      <el-button type=\"primary\" @click=\"showAddDialog\" v-if=\"canAddUser\">\r\n        添加用户\r\n      </el-button>\r\n    </div>\r\n\r\n    <el-table\r\n      v-loading=\"loading\"\r\n      :data=\"users\"\r\n      style=\"width: 100%\">\r\n      <el-table-column prop=\"id\" label=\"ID\" width=\"80\" />\r\n      <el-table-column prop=\"username\" label=\"用户名\" />\r\n      <el-table-column prop=\"role\" label=\"角色\">\r\n        <template #default=\"scope\">\r\n          <el-tag :type=\"getRoleType(scope.row.role)\">\r\n            {{ getRoleName(scope.row.role) }}\r\n          </el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"created_at\" label=\"创建时间\">\r\n        <template #default=\"scope\">\r\n          {{ new Date(scope.row.created_at).toLocaleString() }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\" v-if=\"canEditUser\">\r\n        <template #default=\"scope\">\r\n          <el-button\r\n            size=\"small\"\r\n            type=\"danger\"\r\n            @click=\"handleDelete(scope.row)\"\r\n            v-if=\"canDeleteUser(scope.row)\">\r\n            删除\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 添加用户对话框 -->\r\n    <el-dialog\r\n      title=\"添加用户\"\r\n      v-model=\"dialogVisible\"\r\n      width=\"500px\">\r\n      <el-form\r\n        :model=\"userForm\"\r\n        :rules=\"rules\"\r\n        ref=\"userFormRef\"\r\n        label-width=\"100px\">\r\n        <el-form-item label=\"用户名\" prop=\"username\">\r\n          <el-input \r\n            v-model=\"userForm.username\" \r\n            placeholder=\"请输入用户名\"\r\n            :prefix-icon=\"User\"\r\n            size=\"large\"\r\n            clearable />\r\n        </el-form-item>\r\n        <el-form-item label=\"密码\" prop=\"password\">\r\n          <el-input\r\n            v-model=\"userForm.password\"\r\n            type=\"password\"\r\n            placeholder=\"请输入密码\"\r\n            :prefix-icon=\"Lock\"\r\n            size=\"large\"\r\n            show-password />\r\n        </el-form-item>\r\n        <el-form-item label=\"角色\" prop=\"role\">\r\n          <el-select \r\n            v-model=\"userForm.role\" \r\n            placeholder=\"请选择角色\"\r\n            size=\"large\"\r\n            style=\"width: 100%\">\r\n            <el-option\r\n              v-for=\"role in availableRoles\"\r\n              :key=\"role.value\"\r\n              :label=\"role.label\"\r\n              :value=\"role.value\" />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"dialogVisible = false\">取消</el-button>\r\n          <el-button type=\"primary\" :loading=\"submitLoading\" @click=\"handleSubmit\">\r\n            确定\r\n          </el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, computed, onMounted } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { User, Lock } from '@element-plus/icons-vue'\r\nimport axios from 'axios'\r\n\r\nexport default {\r\n  name: 'Users',\r\n  setup() {\r\n    const store = useStore()\r\n    const loading = ref(false)\r\n    const dialogVisible = ref(false)\r\n    const submitLoading = ref(false)\r\n    const userFormRef = ref(null)\r\n    const userForm = reactive({\r\n      username: '',\r\n      password: '',\r\n      role: ''\r\n    })\r\n\r\n    const rules = {\r\n      username: [\r\n        { required: true, message: '请输入用户名', trigger: 'blur' },\r\n        { min: 3, max: 20, message: '用户名长度应在3-20个字符之间', trigger: 'blur' }\r\n      ],\r\n      password: [\r\n        { required: true, message: '请输入密码', trigger: 'blur' },\r\n        { min: 6, max: 20, message: '密码长度应在6-20个字符之间', trigger: 'blur' }\r\n      ],\r\n      role: [\r\n        { required: true, message: '请选择角色', trigger: 'change' }\r\n      ]\r\n    }\r\n\r\n    const users = computed(() => store.state.users.list)\r\n    const userRole = computed(() => store.state.auth.user?.role)\r\n\r\n    const canAddUser = computed(() => {\r\n      return ['admin', 'pharmacy_admin'].includes(userRole.value)\r\n    })\r\n\r\n    const canEditUser = computed(() => {\r\n      return ['admin', 'pharmacy_admin'].includes(userRole.value)\r\n    })\r\n\r\n    const availableRoles = computed(() => {\r\n      if (userRole.value === 'admin') {\r\n        return [\r\n          { value: 'admin', label: '系统管理员' },\r\n          { value: 'pharmacy_admin', label: '药店管理员' },\r\n          { value: 'salesperson', label: '销售人员' }\r\n        ]\r\n      } else if (userRole.value === 'pharmacy_admin') {\r\n        return [\r\n          { value: 'salesperson', label: '销售人员' }\r\n        ]\r\n      }\r\n      return []\r\n    })\r\n\r\n    const getRoleType = (role) => {\r\n      const types = {\r\n        admin: 'danger',\r\n        pharmacy_admin: 'warning',\r\n        salesperson: 'success'\r\n      }\r\n      return types[role] || 'info'\r\n    }\r\n\r\n    const getRoleName = (role) => {\r\n      const names = {\r\n        admin: '系统管理员',\r\n        pharmacy_admin: '药店管理员',\r\n        salesperson: '销售人员'\r\n      }\r\n      return names[role] || role\r\n    }\r\n\r\n    const canDeleteUser = (user) => {\r\n      if (userRole.value === 'admin') {\r\n        return true\r\n      }\r\n      if (userRole.value === 'pharmacy_admin') {\r\n        return user.role === 'salesperson'\r\n      }\r\n      return false\r\n    }\r\n\r\n    const fetchUsers = async () => {\r\n      try {\r\n        loading.value = true\r\n        await store.dispatch('users/fetchUsers')\r\n      } catch (error) {\r\n        ElMessage.error(error.message)\r\n      } finally {\r\n        loading.value = false\r\n      }\r\n    }\r\n\r\n    const showAddDialog = () => {\r\n      // 重置表单数据\r\n      Object.assign(userForm, {\r\n        username: '',\r\n        password: '',\r\n        role: ''\r\n      })\r\n      dialogVisible.value = true\r\n      // 清除表单验证\r\n      setTimeout(() => {\r\n        if (userFormRef.value) {\r\n          userFormRef.value.clearValidate()\r\n        }\r\n      }, 100)\r\n    }\r\n\r\n    const handleDelete = async (row) => {\r\n      try {\r\n        await ElMessageBox.confirm('确定要删除这个用户吗？', '警告', {\r\n          type: 'warning'\r\n        })\r\n        \r\n        const token = store.state.auth.token\r\n        const config = {\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`\r\n          }\r\n        }\r\n        \r\n        await axios.delete(`http://localhost:5000/api/users/${row.id}`, config)\r\n        ElMessage.success('删除成功')\r\n        fetchUsers()\r\n      } catch (error) {\r\n        if (error !== 'cancel') {\r\n          ElMessage.error(error.response?.data?.message || '删除失败')\r\n        }\r\n      }\r\n    }\r\n\r\n    const handleSubmit = async () => {\r\n      if (!userFormRef.value) return\r\n      \r\n      try {\r\n        // 验证表单\r\n        await userFormRef.value.validate()\r\n        \r\n        submitLoading.value = true\r\n        \r\n        // 设置请求头\r\n        const token = store.state.auth.token\r\n        const config = {\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`,\r\n            'Content-Type': 'application/json'\r\n          }\r\n        }\r\n        \r\n        await axios.post('http://localhost:5000/api/users', userForm, config)\r\n        ElMessage.success('用户添加成功')\r\n        dialogVisible.value = false\r\n        fetchUsers()\r\n      } catch (error) {\r\n        console.error('提交错误:', error)\r\n        if (error.response) {\r\n          ElMessage.error(error.response.data?.message || '操作失败')\r\n        } else if (error.message) {\r\n          ElMessage.error(error.message)\r\n        } else {\r\n          ElMessage.error('请检查输入是否正确')\r\n        }\r\n      } finally {\r\n        submitLoading.value = false\r\n      }\r\n    }\r\n\r\n    onMounted(() => {\r\n      fetchUsers()\r\n    })\r\n\r\n    return {\r\n      loading,\r\n      users,\r\n      dialogVisible,\r\n      userForm,\r\n      userFormRef,\r\n      rules,\r\n      canAddUser,\r\n      canEditUser,\r\n      availableRoles,\r\n      getRoleType,\r\n      getRoleName,\r\n      canDeleteUser,\r\n      showAddDialog,\r\n      handleDelete,\r\n      handleSubmit,\r\n      submitLoading,\r\n      User,\r\n      Lock\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.users-container {\r\n  padding: 20px;\r\n}\r\n\r\n.header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.dialog-footer {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 10px;\r\n}\r\n\r\n:deep(.el-input__wrapper) {\r\n  height: 44px;\r\n}\r\n\r\n:deep(.el-select) {\r\n  width: 100%;\r\n}\r\n\r\n:deep(.el-select .el-input__wrapper) {\r\n  height: 44px;\r\n}\r\n\r\n:deep(.el-form-item__error) {\r\n  padding-top: 4px;\r\n}\r\n\r\n:deep(.el-input__inner) {\r\n  font-size: 14px;\r\n}\r\n</style> "],"mappings":"AA8FA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,QAAQ,EAAEC,SAAQ,QAAS,KAAI;AACvD,SAASC,QAAO,QAAS,MAAK;AAC9B,SAASC,SAAS,EAAEC,YAAW,QAAS,cAAa;AACrD,SAASC,IAAI,EAAEC,IAAG,QAAS,yBAAwB;AACnD,OAAOC,KAAI,MAAO,OAAM;AAExB,eAAe;EACbC,IAAI,EAAE,OAAO;EACbC,KAAKA,CAAA,EAAG;IACN,MAAMC,KAAI,GAAIR,QAAQ,CAAC;IACvB,MAAMS,OAAM,GAAIb,GAAG,CAAC,KAAK;IACzB,MAAMc,aAAY,GAAId,GAAG,CAAC,KAAK;IAC/B,MAAMe,aAAY,GAAIf,GAAG,CAAC,KAAK;IAC/B,MAAMgB,WAAU,GAAIhB,GAAG,CAAC,IAAI;IAC5B,MAAMiB,QAAO,GAAIhB,QAAQ,CAAC;MACxBiB,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE,EAAE;MACZC,IAAI,EAAE;IACR,CAAC;IAED,MAAMC,KAAI,GAAI;MACZH,QAAQ,EAAE,CACR;QAAEI,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,QAAQ;QAAEC,OAAO,EAAE;MAAO,CAAC,EACtD;QAAEC,GAAG,EAAE,CAAC;QAAEC,GAAG,EAAE,EAAE;QAAEH,OAAO,EAAE,kBAAkB;QAAEC,OAAO,EAAE;MAAO,EACjE;MACDL,QAAQ,EAAE,CACR;QAAEG,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,OAAO;QAAEC,OAAO,EAAE;MAAO,CAAC,EACrD;QAAEC,GAAG,EAAE,CAAC;QAAEC,GAAG,EAAE,EAAE;QAAEH,OAAO,EAAE,iBAAiB;QAAEC,OAAO,EAAE;MAAO,EAChE;MACDJ,IAAI,EAAE,CACJ;QAAEE,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,OAAO;QAAEC,OAAO,EAAE;MAAS;IAE1D;IAEA,MAAMG,KAAI,GAAIzB,QAAQ,CAAC,MAAMU,KAAK,CAACgB,KAAK,CAACD,KAAK,CAACE,IAAI;IACnD,MAAMC,QAAO,GAAI5B,QAAQ,CAAC;MAAA,IAAA6B,qBAAA;MAAA,QAAAA,qBAAA,GAAMnB,KAAK,CAACgB,KAAK,CAACI,IAAI,CAACC,IAAI,cAAAF,qBAAA,uBAArBA,qBAAA,CAAuBX,IAAI;IAAA;IAE3D,MAAMc,UAAS,GAAIhC,QAAQ,CAAC,MAAM;MAChC,OAAO,CAAC,OAAO,EAAE,gBAAgB,CAAC,CAACiC,QAAQ,CAACL,QAAQ,CAACM,KAAK;IAC5D,CAAC;IAED,MAAMC,WAAU,GAAInC,QAAQ,CAAC,MAAM;MACjC,OAAO,CAAC,OAAO,EAAE,gBAAgB,CAAC,CAACiC,QAAQ,CAACL,QAAQ,CAACM,KAAK;IAC5D,CAAC;IAED,MAAME,cAAa,GAAIpC,QAAQ,CAAC,MAAM;MACpC,IAAI4B,QAAQ,CAACM,KAAI,KAAM,OAAO,EAAE;QAC9B,OAAO,CACL;UAAEA,KAAK,EAAE,OAAO;UAAEG,KAAK,EAAE;QAAQ,CAAC,EAClC;UAAEH,KAAK,EAAE,gBAAgB;UAAEG,KAAK,EAAE;QAAQ,CAAC,EAC3C;UAAEH,KAAK,EAAE,aAAa;UAAEG,KAAK,EAAE;QAAO,EACxC;MACF,OAAO,IAAIT,QAAQ,CAACM,KAAI,KAAM,gBAAgB,EAAE;QAC9C,OAAO,CACL;UAAEA,KAAK,EAAE,aAAa;UAAEG,KAAK,EAAE;QAAO,EACxC;MACF;MACA,OAAO,EAAC;IACV,CAAC;IAED,MAAMC,WAAU,GAAKpB,IAAI,IAAK;MAC5B,MAAMqB,KAAI,GAAI;QACZC,KAAK,EAAE,QAAQ;QACfC,cAAc,EAAE,SAAS;QACzBC,WAAW,EAAE;MACf;MACA,OAAOH,KAAK,CAACrB,IAAI,KAAK,MAAK;IAC7B;IAEA,MAAMyB,WAAU,GAAKzB,IAAI,IAAK;MAC5B,MAAM0B,KAAI,GAAI;QACZJ,KAAK,EAAE,OAAO;QACdC,cAAc,EAAE,OAAO;QACvBC,WAAW,EAAE;MACf;MACA,OAAOE,KAAK,CAAC1B,IAAI,KAAKA,IAAG;IAC3B;IAEA,MAAM2B,aAAY,GAAKd,IAAI,IAAK;MAC9B,IAAIH,QAAQ,CAACM,KAAI,KAAM,OAAO,EAAE;QAC9B,OAAO,IAAG;MACZ;MACA,IAAIN,QAAQ,CAACM,KAAI,KAAM,gBAAgB,EAAE;QACvC,OAAOH,IAAI,CAACb,IAAG,KAAM,aAAY;MACnC;MACA,OAAO,KAAI;IACb;IAEA,MAAM4B,UAAS,GAAI,MAAAA,CAAA,KAAY;MAC7B,IAAI;QACFnC,OAAO,CAACuB,KAAI,GAAI,IAAG;QACnB,MAAMxB,KAAK,CAACqC,QAAQ,CAAC,kBAAkB;MACzC,EAAE,OAAOC,KAAK,EAAE;QACd7C,SAAS,CAAC6C,KAAK,CAACA,KAAK,CAAC3B,OAAO;MAC/B,UAAU;QACRV,OAAO,CAACuB,KAAI,GAAI,KAAI;MACtB;IACF;IAEA,MAAMe,aAAY,GAAIA,CAAA,KAAM;MAC1B;MACAC,MAAM,CAACC,MAAM,CAACpC,QAAQ,EAAE;QACtBC,QAAQ,EAAE,EAAE;QACZC,QAAQ,EAAE,EAAE;QACZC,IAAI,EAAE;MACR,CAAC;MACDN,aAAa,CAACsB,KAAI,GAAI,IAAG;MACzB;MACAkB,UAAU,CAAC,MAAM;QACf,IAAItC,WAAW,CAACoB,KAAK,EAAE;UACrBpB,WAAW,CAACoB,KAAK,CAACmB,aAAa,CAAC;QAClC;MACF,CAAC,EAAE,GAAG;IACR;IAEA,MAAMC,YAAW,GAAI,MAAOC,GAAG,IAAK;MAClC,IAAI;QACF,MAAMnD,YAAY,CAACoD,OAAO,CAAC,aAAa,EAAE,IAAI,EAAE;UAC9CC,IAAI,EAAE;QACR,CAAC;QAED,MAAMC,KAAI,GAAIhD,KAAK,CAACgB,KAAK,CAACI,IAAI,CAAC4B,KAAI;QACnC,MAAMC,MAAK,GAAI;UACbC,OAAO,EAAE;YACP,eAAe,EAAE,UAAUF,KAAK;UAClC;QACF;QAEA,MAAMnD,KAAK,CAACsD,MAAM,CAAC,mCAAmCN,GAAG,CAACO,EAAE,EAAE,EAAEH,MAAM;QACtExD,SAAS,CAAC4D,OAAO,CAAC,MAAM;QACxBjB,UAAU,CAAC;MACb,EAAE,OAAOE,KAAK,EAAE;QACd,IAAIA,KAAI,KAAM,QAAQ,EAAE;UAAA,IAAAgB,eAAA,EAAAC,oBAAA;UACtB9D,SAAS,CAAC6C,KAAK,CAAC,EAAAgB,eAAA,GAAAhB,KAAK,CAACkB,QAAQ,cAAAF,eAAA,wBAAAC,oBAAA,GAAdD,eAAA,CAAgBG,IAAI,cAAAF,oBAAA,uBAApBA,oBAAA,CAAsB5C,OAAM,KAAK,MAAM;QACzD;MACF;IACF;IAEA,MAAM+C,YAAW,GAAI,MAAAA,CAAA,KAAY;MAC/B,IAAI,CAACtD,WAAW,CAACoB,KAAK,EAAE;MAExB,IAAI;QACF;QACA,MAAMpB,WAAW,CAACoB,KAAK,CAACmC,QAAQ,CAAC;QAEjCxD,aAAa,CAACqB,KAAI,GAAI,IAAG;;QAEzB;QACA,MAAMwB,KAAI,GAAIhD,KAAK,CAACgB,KAAK,CAACI,IAAI,CAAC4B,KAAI;QACnC,MAAMC,MAAK,GAAI;UACbC,OAAO,EAAE;YACP,eAAe,EAAE,UAAUF,KAAK,EAAE;YAClC,cAAc,EAAE;UAClB;QACF;QAEA,MAAMnD,KAAK,CAAC+D,IAAI,CAAC,iCAAiC,EAAEvD,QAAQ,EAAE4C,MAAM;QACpExD,SAAS,CAAC4D,OAAO,CAAC,QAAQ;QAC1BnD,aAAa,CAACsB,KAAI,GAAI,KAAI;QAC1BY,UAAU,CAAC;MACb,EAAE,OAAOE,KAAK,EAAE;QACduB,OAAO,CAACvB,KAAK,CAAC,OAAO,EAAEA,KAAK;QAC5B,IAAIA,KAAK,CAACkB,QAAQ,EAAE;UAAA,IAAAM,qBAAA;UAClBrE,SAAS,CAAC6C,KAAK,CAAC,EAAAwB,qBAAA,GAAAxB,KAAK,CAACkB,QAAQ,CAACC,IAAI,cAAAK,qBAAA,uBAAnBA,qBAAA,CAAqBnD,OAAM,KAAK,MAAM;QACxD,OAAO,IAAI2B,KAAK,CAAC3B,OAAO,EAAE;UACxBlB,SAAS,CAAC6C,KAAK,CAACA,KAAK,CAAC3B,OAAO;QAC/B,OAAO;UACLlB,SAAS,CAAC6C,KAAK,CAAC,WAAW;QAC7B;MACF,UAAU;QACRnC,aAAa,CAACqB,KAAI,GAAI,KAAI;MAC5B;IACF;IAEAjC,SAAS,CAAC,MAAM;MACd6C,UAAU,CAAC;IACb,CAAC;IAED,OAAO;MACLnC,OAAO;MACPc,KAAK;MACLb,aAAa;MACbG,QAAQ;MACRD,WAAW;MACXK,KAAK;MACLa,UAAU;MACVG,WAAW;MACXC,cAAc;MACdE,WAAW;MACXK,WAAW;MACXE,aAAa;MACbI,aAAa;MACbK,YAAY;MACZc,YAAY;MACZvD,aAAa;MACbR,IAAI;MACJC;IACF;EACF;AACF","ignoreList":[]}]}